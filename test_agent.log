2025-05-13 06:09:21,617 - test.module - INFO - Test message
2025-05-13 06:09:21,620 - src.main - INFO - Creating data directory: data
2025-05-13 06:09:21,624 - src.main - WARNING - File not found: /nonexistent/file.json. Returning default.
2025-05-13 06:09:21,625 - src.main - ERROR - Error decoding JSON from /tmp/pytest-of-todd/pytest-17/test_load_json_invalid_format0/invalid.json: Expecting value: line 1 column 1 (char 0). Returning default.
2025-05-13 06:09:21,625 - src.main - INFO - Successfully saved 0 seeds to Markdown: /tmp/pytest-of-todd/pytest-17/test_save_seeds_empty0/test_sparks.md
2025-05-13 06:09:21,626 - src.main - INFO - Successfully saved 1 seeds to Markdown: /tmp/pytest-of-todd/pytest-17/test_save_seeds_with_data0/test_sparks.md
2025-05-13 06:09:21,627 - src.main - INFO - Successfully saved 2 seeds to Markdown: /tmp/pytest-of-todd/pytest-17/test_save_seeds_multiple0/test_sparks.md
2025-05-13 06:09:21,629 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:09:21,629 - src.main - INFO - Fetching new items...
2025-05-13 06:09:21,629 - src.main - INFO - No new items fetched in this cycle.
2025-05-13 06:09:21,629 - src.main - INFO - --- Agent Cycle Complete (No new items) ---
2025-05-13 06:09:21,630 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:09:21,630 - src.main - INFO - Fetching new items...
2025-05-13 06:09:21,630 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:09:21,630 - src.main - INFO - Detecting sparks...
2025-05-13 06:09:21,630 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:09:21,630 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:09:21,632 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:09:21,632 - src.main - INFO - Fetching new items...
2025-05-13 06:09:21,632 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:09:21,632 - src.main - INFO - Detecting sparks...
2025-05-13 06:09:21,632 - src.main - INFO - Generating story seeds for 2 sparks...
2025-05-13 06:09:21,632 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:09:21,632 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:09:21,632 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:09:21,632 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:09:21,634 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:09:21,634 - src.main - INFO - Fetching new items...
2025-05-13 06:09:21,634 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:09:21,634 - src.main - INFO - Detecting sparks...
2025-05-13 06:09:21,634 - src.main - INFO - Limiting seed generation to 2 sparks (out of 4 detected).
2025-05-13 06:09:21,634 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:09:21,634 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:09:21,634 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:09:21,634 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:09:21,635 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:09:21,635 - src.main - INFO - Fetching new items...
2025-05-13 06:09:21,635 - src.main - INFO - Purged 1 old items from history (older than 7 days).
2025-05-13 06:09:21,635 - src.main - INFO - History contains 2 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:09:21,635 - src.main - INFO - Detecting sparks...
2025-05-13 06:09:21,635 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:09:21,635 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:09:21,637 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:09:21,637 - src.main - INFO - Fetching new items...
2025-05-13 06:09:21,637 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:09:21,637 - src.main - INFO - Detecting sparks...
2025-05-13 06:09:21,637 - src.main - INFO - Generating story seeds for 1 sparks...
2025-05-13 06:09:21,637 - src.main - ERROR - Failed to configure Gemini API. Skipping seed generation.
2025-05-13 06:09:21,637 - src.main - INFO - Generated 0 story seeds.
2025-05-13 06:09:21,637 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:09:21,640 - src.story_seed_generator - INFO - Google Generative AI client configured successfully.
2025-05-13 06:09:21,641 - src.story_seed_generator - ERROR - GOOGLE_API_KEY environment variable not set or found in .env file.
2025-05-13 06:09:21,645 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:09:21,646 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:09:21,652 - src.story_seed_generator - WARNING - Could not parse 'What If Questions' from LLM response.
Response snippet:

        Logline: A story about time travel.
        
        What If Questions:
        - What if time travel was real?
        ...
2025-05-13 06:09:21,652 - src.story_seed_generator - WARNING - Received empty text from Gemini response for parsing.
2025-05-13 06:09:21,653 - src.story_seed_generator - WARNING - Could not parse Logline from LLM response.
Response snippet:
This is not a properly formatted response...
2025-05-13 06:09:21,656 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:09:21,656 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:09:21,656 - src.story_seed_generator - INFO - Successfully generated and parsed story seed for spark: 'quantum'
2025-05-13 06:09:21,657 - src.story_seed_generator - INFO - Attempting to configure Gemini API before generation...
2025-05-13 06:09:21,657 - src.story_seed_generator - ERROR - Gemini client not configured and configuration attempt failed. Cannot generate seed.
2025-05-13 06:09:21,659 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:09:21,659 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 1/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:09:21,659 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 2/3) after 1 seconds...
2025-05-13 06:09:22,660 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 2/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:09:22,661 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 3/3) after 2 seconds...
2025-05-13 06:09:24,663 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 3/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:09:24,664 - src.story_seed_generator - ERROR - Failed to generate story seed after 3 attempts due to API errors.
2025-05-13 06:09:24,666 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:09:24,666 - src.story_seed_generator - WARNING - Gemini API returned no text content for spark 'quantum' (Attempt 1/3). Finish Reason: SAFETY, Block Reason: None, Safety Ratings: <Mock name='mock.safety_ratings' id='140361755863952'>
2025-05-13 06:09:24,666 - src.story_seed_generator - WARNING - Generation stopped due to safety/recitation (SAFETY). No retry.
2025-05-13 06:09:24,667 - src.story_seed_generator - ERROR - Prompt template 'generation.prompt_template' is missing in the configuration.
2025-05-13 06:09:24,669 - src.trend_detector - INFO - Analyzing 3 new items against 2 history items for sparks.
2025-05-13 06:09:24,670 - src.trend_detector - INFO - Detected Spark: 'quantum' from source 'test_source' (New Freq: 4, Hist Freq: 0) - Assoc. item: Another Quantum Development
2025-05-13 06:09:24,670 - src.trend_detector - INFO - Detected Spark: 'computing' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Quantum Computing Breakthrough Announced
2025-05-13 06:09:24,670 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:09:24,670 - src.trend_detector - INFO - Analyzing 1 new items against 1 history items for sparks.
2025-05-13 06:09:24,670 - src.trend_detector - INFO - Detected 0 sparks in this cycle.
2025-05-13 06:09:24,671 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:09:24,671 - src.trend_detector - INFO - Detected Spark: 'different' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:09:24,671 - src.trend_detector - INFO - Detected Spark: 'unique' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:09:24,671 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:09:24,672 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:09:24,672 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:09:24,672 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:09:24,673 - src.trend_detector - INFO - Detected Spark: 'blockchain' from source 'source2' (New Freq: 4, Hist Freq: 0) - Assoc. item: Blockchain Revolution
2025-05-13 06:09:24,673 - src.trend_detector - INFO - Detected 1 sparks in this cycle.
2025-05-13 06:11:02,772 - test.module - INFO - Test message
2025-05-13 06:11:02,775 - src.main - INFO - Creating data directory: data
2025-05-13 06:11:02,779 - src.main - WARNING - File not found: /nonexistent/file.json. Returning default.
2025-05-13 06:11:02,780 - src.main - ERROR - Error decoding JSON from /tmp/pytest-of-todd/pytest-18/test_load_json_invalid_format0/invalid.json: Expecting value: line 1 column 1 (char 0). Returning default.
2025-05-13 06:11:02,780 - src.main - INFO - Successfully saved 0 seeds to Markdown: /tmp/pytest-of-todd/pytest-18/test_save_seeds_empty0/test_sparks.md
2025-05-13 06:11:02,781 - src.main - INFO - Successfully saved 1 seeds to Markdown: /tmp/pytest-of-todd/pytest-18/test_save_seeds_with_data0/test_sparks.md
2025-05-13 06:11:02,782 - src.main - INFO - Successfully saved 2 seeds to Markdown: /tmp/pytest-of-todd/pytest-18/test_save_seeds_multiple0/test_sparks.md
2025-05-13 06:11:02,784 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:02,785 - src.main - INFO - Fetching new items...
2025-05-13 06:11:02,785 - src.main - INFO - No new items fetched in this cycle.
2025-05-13 06:11:02,785 - src.main - INFO - --- Agent Cycle Complete (No new items) ---
2025-05-13 06:11:02,787 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:02,787 - src.main - INFO - Fetching new items...
2025-05-13 06:11:02,787 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:02,787 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:02,787 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:11:02,788 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:11:02,790 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:02,790 - src.main - INFO - Fetching new items...
2025-05-13 06:11:02,790 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:02,791 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:02,791 - src.main - INFO - Generating story seeds for 2 sparks...
2025-05-13 06:11:02,791 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:11:02,791 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:11:02,791 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:11:02,791 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:11:02,793 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:02,793 - src.main - INFO - Fetching new items...
2025-05-13 06:11:02,793 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:02,793 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:02,793 - src.main - INFO - Limiting seed generation to 2 sparks (out of 4 detected).
2025-05-13 06:11:02,793 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:11:02,793 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:11:02,793 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:11:02,793 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:11:02,794 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:02,795 - src.main - INFO - Fetching new items...
2025-05-13 06:11:02,795 - src.main - INFO - Purged 1 old items from history (older than 7 days).
2025-05-13 06:11:02,795 - src.main - INFO - History contains 2 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:02,795 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:02,795 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:11:02,795 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:11:02,796 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:02,796 - src.main - INFO - Fetching new items...
2025-05-13 06:11:02,796 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:02,796 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:02,796 - src.main - INFO - Generating story seeds for 1 sparks...
2025-05-13 06:11:02,796 - src.main - ERROR - Failed to configure Gemini API. Skipping seed generation.
2025-05-13 06:11:02,797 - src.main - INFO - Generated 0 story seeds.
2025-05-13 06:11:02,797 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:11:02,799 - src.main - INFO - Creating data directory: /tmp/tmpm9zv3aq_/nonexistent
2025-05-13 06:11:02,800 - src.main - INFO - Creating data directory: /tmp/tmpj0r3ifa0/subdir
2025-05-13 06:11:02,801 - src.main - WARNING - File not found: /tmp/tmp1hdtxt_1/nonexistent.json. Returning default.
2025-05-13 06:11:02,802 - src.main - ERROR - Error decoding JSON from /tmp/tmpes2gk6es/invalid.json: Expecting value: line 1 column 1 (char 0). Returning default.
2025-05-13 06:11:02,803 - src.main - INFO - Successfully saved 0 seeds to Markdown: /tmp/tmp1fk4m2ph/output.md
2025-05-13 06:11:02,803 - src.main - INFO - Successfully saved 1 seeds to Markdown: /tmp/tmpd030pepm/output.md
2025-05-13 06:11:02,804 - src.main - ERROR - Error saving seeds to Markdown file /invalid/path.md: Cannot write
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/main.py", line 135, in save_seeds_to_markdown
    with open(filepath, 'w', encoding='utf-8') as f:
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
OSError: Cannot write
2025-05-13 06:11:02,810 - src.config_loader - INFO - Configuration loaded successfully from 'config.yaml'
2025-05-13 06:11:02,810 - src.config_loader - INFO - Configuration validated successfully.
2025-05-13 06:11:41,047 - test.module - INFO - Test message
2025-05-13 06:11:41,050 - src.main - INFO - Creating data directory: data
2025-05-13 06:11:41,054 - src.main - WARNING - File not found: /nonexistent/file.json. Returning default.
2025-05-13 06:11:41,055 - src.main - ERROR - Error decoding JSON from /tmp/pytest-of-todd/pytest-19/test_load_json_invalid_format0/invalid.json: Expecting value: line 1 column 1 (char 0). Returning default.
2025-05-13 06:11:41,055 - src.main - INFO - Successfully saved 0 seeds to Markdown: /tmp/pytest-of-todd/pytest-19/test_save_seeds_empty0/test_sparks.md
2025-05-13 06:11:41,056 - src.main - INFO - Successfully saved 1 seeds to Markdown: /tmp/pytest-of-todd/pytest-19/test_save_seeds_with_data0/test_sparks.md
2025-05-13 06:11:41,057 - src.main - INFO - Successfully saved 2 seeds to Markdown: /tmp/pytest-of-todd/pytest-19/test_save_seeds_multiple0/test_sparks.md
2025-05-13 06:11:41,059 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:41,059 - src.main - INFO - Fetching new items...
2025-05-13 06:11:41,059 - src.main - INFO - No new items fetched in this cycle.
2025-05-13 06:11:41,059 - src.main - INFO - --- Agent Cycle Complete (No new items) ---
2025-05-13 06:11:41,060 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:41,060 - src.main - INFO - Fetching new items...
2025-05-13 06:11:41,060 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:41,060 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:41,060 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:11:41,060 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:11:41,062 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:41,062 - src.main - INFO - Fetching new items...
2025-05-13 06:11:41,062 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:41,062 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:41,062 - src.main - INFO - Generating story seeds for 2 sparks...
2025-05-13 06:11:41,062 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:11:41,062 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:11:41,062 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:11:41,062 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:11:41,064 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:41,064 - src.main - INFO - Fetching new items...
2025-05-13 06:11:41,064 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:41,064 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:41,064 - src.main - INFO - Limiting seed generation to 2 sparks (out of 4 detected).
2025-05-13 06:11:41,064 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:11:41,064 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:11:41,064 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:11:41,065 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:11:41,066 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:41,066 - src.main - INFO - Fetching new items...
2025-05-13 06:11:41,066 - src.main - INFO - Purged 1 old items from history (older than 7 days).
2025-05-13 06:11:41,066 - src.main - INFO - History contains 2 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:41,066 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:41,066 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:11:41,066 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:11:41,067 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:41,068 - src.main - INFO - Fetching new items...
2025-05-13 06:11:41,068 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:41,068 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:41,068 - src.main - INFO - Generating story seeds for 1 sparks...
2025-05-13 06:11:41,068 - src.main - ERROR - Failed to configure Gemini API. Skipping seed generation.
2025-05-13 06:11:41,068 - src.main - INFO - Generated 0 story seeds.
2025-05-13 06:11:41,068 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:11:41,071 - src.main - INFO - Creating data directory: /tmp/tmpu_c5budh/nonexistent
2025-05-13 06:11:41,072 - src.main - INFO - Creating data directory: /tmp/tmpg44qj9e1/subdir
2025-05-13 06:11:41,073 - src.main - WARNING - File not found: /tmp/tmp124qid9i/nonexistent.json. Returning default.
2025-05-13 06:11:41,074 - src.main - ERROR - Error decoding JSON from /tmp/tmpegpv46wh/invalid.json: Expecting value: line 1 column 1 (char 0). Returning default.
2025-05-13 06:11:41,074 - src.main - INFO - Successfully saved 0 seeds to Markdown: /tmp/tmpf1y7w4qw/output.md
2025-05-13 06:11:41,075 - src.main - INFO - Successfully saved 1 seeds to Markdown: /tmp/tmpjjpmd6o3/output.md
2025-05-13 06:11:41,076 - src.main - ERROR - Error saving seeds to Markdown file /invalid/path.md: Cannot write
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/main.py", line 135, in save_seeds_to_markdown
    with open(filepath, 'w', encoding='utf-8') as f:
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
OSError: Cannot write
2025-05-13 06:11:41,082 - src.config_loader - INFO - Configuration loaded successfully from 'config.yaml'
2025-05-13 06:11:41,082 - src.config_loader - INFO - Configuration validated successfully.
2025-05-13 06:11:58,465 - test.module - INFO - Test message
2025-05-13 06:11:58,469 - src.main - INFO - Creating data directory: data
2025-05-13 06:11:58,473 - src.main - WARNING - File not found: /nonexistent/file.json. Returning default.
2025-05-13 06:11:58,474 - src.main - ERROR - Error decoding JSON from /tmp/pytest-of-todd/pytest-20/test_load_json_invalid_format0/invalid.json: Expecting value: line 1 column 1 (char 0). Returning default.
2025-05-13 06:11:58,474 - src.main - INFO - Successfully saved 0 seeds to Markdown: /tmp/pytest-of-todd/pytest-20/test_save_seeds_empty0/test_sparks.md
2025-05-13 06:11:58,475 - src.main - INFO - Successfully saved 1 seeds to Markdown: /tmp/pytest-of-todd/pytest-20/test_save_seeds_with_data0/test_sparks.md
2025-05-13 06:11:58,476 - src.main - INFO - Successfully saved 2 seeds to Markdown: /tmp/pytest-of-todd/pytest-20/test_save_seeds_multiple0/test_sparks.md
2025-05-13 06:11:58,478 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:58,478 - src.main - INFO - Fetching new items...
2025-05-13 06:11:58,478 - src.main - INFO - No new items fetched in this cycle.
2025-05-13 06:11:58,478 - src.main - INFO - --- Agent Cycle Complete (No new items) ---
2025-05-13 06:11:58,479 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:58,479 - src.main - INFO - Fetching new items...
2025-05-13 06:11:58,479 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:58,479 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:58,479 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:11:58,479 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:11:58,481 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:58,481 - src.main - INFO - Fetching new items...
2025-05-13 06:11:58,481 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:58,481 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:58,481 - src.main - INFO - Generating story seeds for 2 sparks...
2025-05-13 06:11:58,481 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:11:58,481 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:11:58,481 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:11:58,481 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:11:58,482 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:58,483 - src.main - INFO - Fetching new items...
2025-05-13 06:11:58,483 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:58,483 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:58,483 - src.main - INFO - Limiting seed generation to 2 sparks (out of 4 detected).
2025-05-13 06:11:58,483 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:11:58,483 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:11:58,483 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:11:58,483 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:11:58,484 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:58,484 - src.main - INFO - Fetching new items...
2025-05-13 06:11:58,485 - src.main - INFO - Purged 1 old items from history (older than 7 days).
2025-05-13 06:11:58,485 - src.main - INFO - History contains 2 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:58,485 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:58,485 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:11:58,485 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:11:58,486 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:11:58,486 - src.main - INFO - Fetching new items...
2025-05-13 06:11:58,486 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:11:58,486 - src.main - INFO - Detecting sparks...
2025-05-13 06:11:58,486 - src.main - INFO - Generating story seeds for 1 sparks...
2025-05-13 06:11:58,486 - src.main - ERROR - Failed to configure Gemini API. Skipping seed generation.
2025-05-13 06:11:58,486 - src.main - INFO - Generated 0 story seeds.
2025-05-13 06:11:58,486 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:11:58,489 - src.story_seed_generator - INFO - Google Generative AI client configured successfully.
2025-05-13 06:11:58,491 - src.story_seed_generator - ERROR - GOOGLE_API_KEY environment variable not set or found in .env file.
2025-05-13 06:11:58,494 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:11:58,495 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:11:58,501 - src.story_seed_generator - WARNING - Could not parse 'What If Questions' from LLM response.
Response snippet:

        Logline: A story about time travel.
        
        What If Questions:
        - What if time travel was real?
        ...
2025-05-13 06:11:58,502 - src.story_seed_generator - WARNING - Received empty text from Gemini response for parsing.
2025-05-13 06:11:58,502 - src.story_seed_generator - WARNING - Could not parse Logline from LLM response.
Response snippet:
This is not a properly formatted response...
2025-05-13 06:11:58,506 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:11:58,506 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:11:58,506 - src.story_seed_generator - INFO - Successfully generated and parsed story seed for spark: 'quantum'
2025-05-13 06:11:58,507 - src.story_seed_generator - INFO - Attempting to configure Gemini API before generation...
2025-05-13 06:11:58,507 - src.story_seed_generator - ERROR - Gemini client not configured and configuration attempt failed. Cannot generate seed.
2025-05-13 06:11:58,508 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:11:58,508 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 1/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:11:58,509 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 2/3) after 1 seconds...
2025-05-13 06:11:59,510 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 2/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:11:59,511 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 3/3) after 2 seconds...
2025-05-13 06:12:01,513 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 3/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:12:01,513 - src.story_seed_generator - ERROR - Failed to generate story seed after 3 attempts due to API errors.
2025-05-13 06:12:01,516 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:12:01,516 - src.story_seed_generator - WARNING - Gemini API returned no text content for spark 'quantum' (Attempt 1/3). Finish Reason: SAFETY, Block Reason: None, Safety Ratings: <Mock name='mock.safety_ratings' id='140387729093488'>
2025-05-13 06:12:01,516 - src.story_seed_generator - WARNING - Generation stopped due to safety/recitation (SAFETY). No retry.
2025-05-13 06:12:01,517 - src.story_seed_generator - ERROR - Prompt template 'generation.prompt_template' is missing in the configuration.
2025-05-13 06:12:01,519 - src.trend_detector - INFO - Analyzing 3 new items against 2 history items for sparks.
2025-05-13 06:12:01,520 - src.trend_detector - INFO - Detected Spark: 'quantum' from source 'test_source' (New Freq: 4, Hist Freq: 0) - Assoc. item: Another Quantum Development
2025-05-13 06:12:01,520 - src.trend_detector - INFO - Detected Spark: 'computing' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Quantum Computing Breakthrough Announced
2025-05-13 06:12:01,520 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:12:01,520 - src.trend_detector - INFO - Analyzing 1 new items against 1 history items for sparks.
2025-05-13 06:12:01,521 - src.trend_detector - INFO - Detected 0 sparks in this cycle.
2025-05-13 06:12:01,521 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:12:01,521 - src.trend_detector - INFO - Detected Spark: 'unique' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:12:01,521 - src.trend_detector - INFO - Detected Spark: 'different' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:12:01,521 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:12:01,522 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:12:01,522 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:12:01,523 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:12:01,523 - src.trend_detector - INFO - Detected Spark: 'blockchain' from source 'source2' (New Freq: 4, Hist Freq: 0) - Assoc. item: Blockchain Revolution
2025-05-13 06:12:01,523 - src.trend_detector - INFO - Detected 1 sparks in this cycle.
2025-05-13 06:12:57,340 - test.module - INFO - Test message
2025-05-13 06:12:57,344 - src.main - INFO - Creating data directory: data
2025-05-13 06:12:57,348 - src.main - WARNING - File not found: /nonexistent/file.json. Returning default.
2025-05-13 06:12:57,349 - src.main - ERROR - Error decoding JSON from /tmp/pytest-of-todd/pytest-21/test_load_json_invalid_format0/invalid.json: Expecting value: line 1 column 1 (char 0). Returning default.
2025-05-13 06:12:57,349 - src.main - INFO - Successfully saved 0 seeds to Markdown: /tmp/pytest-of-todd/pytest-21/test_save_seeds_empty0/test_sparks.md
2025-05-13 06:12:57,350 - src.main - INFO - Successfully saved 1 seeds to Markdown: /tmp/pytest-of-todd/pytest-21/test_save_seeds_with_data0/test_sparks.md
2025-05-13 06:12:57,351 - src.main - INFO - Successfully saved 2 seeds to Markdown: /tmp/pytest-of-todd/pytest-21/test_save_seeds_multiple0/test_sparks.md
2025-05-13 06:12:57,353 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:12:57,353 - src.main - INFO - Fetching new items...
2025-05-13 06:12:57,353 - src.main - INFO - No new items fetched in this cycle.
2025-05-13 06:12:57,353 - src.main - INFO - --- Agent Cycle Complete (No new items) ---
2025-05-13 06:12:57,354 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:12:57,354 - src.main - INFO - Fetching new items...
2025-05-13 06:12:57,354 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:12:57,354 - src.main - INFO - Detecting sparks...
2025-05-13 06:12:57,354 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:12:57,354 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:12:57,356 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:12:57,356 - src.main - INFO - Fetching new items...
2025-05-13 06:12:57,356 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:12:57,356 - src.main - INFO - Detecting sparks...
2025-05-13 06:12:57,356 - src.main - INFO - Generating story seeds for 2 sparks...
2025-05-13 06:12:57,356 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:12:57,356 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:12:57,356 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:12:57,356 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:12:57,358 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:12:57,358 - src.main - INFO - Fetching new items...
2025-05-13 06:12:57,358 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:12:57,358 - src.main - INFO - Detecting sparks...
2025-05-13 06:12:57,358 - src.main - INFO - Limiting seed generation to 2 sparks (out of 4 detected).
2025-05-13 06:12:57,358 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:12:57,358 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:12:57,358 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:12:57,358 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:12:57,359 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:12:57,359 - src.main - INFO - Fetching new items...
2025-05-13 06:12:57,359 - src.main - INFO - Purged 1 old items from history (older than 7 days).
2025-05-13 06:12:57,359 - src.main - INFO - History contains 2 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:12:57,359 - src.main - INFO - Detecting sparks...
2025-05-13 06:12:57,359 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:12:57,360 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:12:57,361 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:12:57,361 - src.main - INFO - Fetching new items...
2025-05-13 06:12:57,361 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:12:57,361 - src.main - INFO - Detecting sparks...
2025-05-13 06:12:57,361 - src.main - INFO - Generating story seeds for 1 sparks...
2025-05-13 06:12:57,361 - src.main - ERROR - Failed to configure Gemini API. Skipping seed generation.
2025-05-13 06:12:57,361 - src.main - INFO - Generated 0 story seeds.
2025-05-13 06:12:57,361 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:12:57,365 - src.story_seed_generator - INFO - Google Generative AI client configured successfully.
2025-05-13 06:12:57,366 - src.story_seed_generator - ERROR - GOOGLE_API_KEY environment variable not set or found in .env file.
2025-05-13 06:12:57,369 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:12:57,370 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:12:57,376 - src.story_seed_generator - WARNING - Could not parse 'What If Questions' from LLM response.
Response snippet:

        Logline: A story about time travel.
        
        What If Questions:
        - What if time travel was real?
        ...
2025-05-13 06:12:57,376 - src.story_seed_generator - WARNING - Received empty text from Gemini response for parsing.
2025-05-13 06:12:57,377 - src.story_seed_generator - WARNING - Could not parse Logline from LLM response.
Response snippet:
This is not a properly formatted response...
2025-05-13 06:12:57,380 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:12:57,381 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:12:57,381 - src.story_seed_generator - INFO - Successfully generated and parsed story seed for spark: 'quantum'
2025-05-13 06:12:57,382 - src.story_seed_generator - INFO - Attempting to configure Gemini API before generation...
2025-05-13 06:12:57,382 - src.story_seed_generator - ERROR - Gemini client not configured and configuration attempt failed. Cannot generate seed.
2025-05-13 06:12:57,383 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:12:57,383 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 1/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:12:57,383 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 2/3) after 1 seconds...
2025-05-13 06:12:58,385 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 2/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:12:58,385 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 3/3) after 2 seconds...
2025-05-13 06:13:00,387 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 3/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:13:00,388 - src.story_seed_generator - ERROR - Failed to generate story seed after 3 attempts due to API errors.
2025-05-13 06:13:00,390 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:13:00,390 - src.story_seed_generator - WARNING - Gemini API returned no text content for spark 'quantum' (Attempt 1/3). Finish Reason: SAFETY, Block Reason: None, Safety Ratings: <Mock name='mock.safety_ratings' id='140516256876528'>
2025-05-13 06:13:00,390 - src.story_seed_generator - WARNING - Generation stopped due to safety/recitation (SAFETY). No retry.
2025-05-13 06:13:00,391 - src.story_seed_generator - ERROR - Prompt template 'generation.prompt_template' is missing in the configuration.
2025-05-13 06:13:00,393 - src.trend_detector - INFO - Analyzing 3 new items against 2 history items for sparks.
2025-05-13 06:13:00,394 - src.trend_detector - INFO - Detected Spark: 'computing' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Quantum Computing Breakthrough Announced
2025-05-13 06:13:00,394 - src.trend_detector - INFO - Detected Spark: 'quantum' from source 'test_source' (New Freq: 4, Hist Freq: 0) - Assoc. item: Another Quantum Development
2025-05-13 06:13:00,394 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:13:00,395 - src.trend_detector - INFO - Analyzing 1 new items against 1 history items for sparks.
2025-05-13 06:13:00,395 - src.trend_detector - INFO - Detected 0 sparks in this cycle.
2025-05-13 06:13:00,395 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:13:00,395 - src.trend_detector - INFO - Detected Spark: 'unique' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:13:00,395 - src.trend_detector - INFO - Detected Spark: 'different' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:13:00,395 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:13:00,396 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:13:00,396 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:13:00,397 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:13:00,397 - src.trend_detector - INFO - Detected Spark: 'blockchain' from source 'source2' (New Freq: 4, Hist Freq: 0) - Assoc. item: Blockchain Revolution
2025-05-13 06:13:00,397 - src.trend_detector - INFO - Detected 1 sparks in this cycle.
2025-05-13 06:13:15,586 - test.module - INFO - Test message
2025-05-13 06:13:15,591 - src.main - INFO - Creating data directory: data
2025-05-13 06:13:15,595 - src.main - WARNING - File not found: /nonexistent/file.json. Returning default.
2025-05-13 06:13:15,596 - src.main - ERROR - Error decoding JSON from /tmp/pytest-of-todd/pytest-22/test_load_json_invalid_format0/invalid.json: Expecting value: line 1 column 1 (char 0). Returning default.
2025-05-13 06:13:15,597 - src.main - INFO - Successfully saved 0 seeds to Markdown: /tmp/pytest-of-todd/pytest-22/test_save_seeds_empty0/test_sparks.md
2025-05-13 06:13:15,598 - src.main - INFO - Successfully saved 1 seeds to Markdown: /tmp/pytest-of-todd/pytest-22/test_save_seeds_with_data0/test_sparks.md
2025-05-13 06:13:15,599 - src.main - INFO - Successfully saved 2 seeds to Markdown: /tmp/pytest-of-todd/pytest-22/test_save_seeds_multiple0/test_sparks.md
2025-05-13 06:13:15,600 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:15,600 - src.main - INFO - Fetching new items...
2025-05-13 06:13:15,600 - src.main - INFO - No new items fetched in this cycle.
2025-05-13 06:13:15,600 - src.main - INFO - --- Agent Cycle Complete (No new items) ---
2025-05-13 06:13:15,602 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:15,602 - src.main - INFO - Fetching new items...
2025-05-13 06:13:15,602 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:13:15,602 - src.main - INFO - Detecting sparks...
2025-05-13 06:13:15,602 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:13:15,602 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:13:15,603 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:15,603 - src.main - INFO - Fetching new items...
2025-05-13 06:13:15,603 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:13:15,604 - src.main - INFO - Detecting sparks...
2025-05-13 06:13:15,604 - src.main - INFO - Generating story seeds for 2 sparks...
2025-05-13 06:13:15,604 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:13:15,604 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:13:15,604 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:13:15,604 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:13:15,605 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:15,605 - src.main - INFO - Fetching new items...
2025-05-13 06:13:15,605 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:13:15,605 - src.main - INFO - Detecting sparks...
2025-05-13 06:13:15,605 - src.main - INFO - Limiting seed generation to 2 sparks (out of 4 detected).
2025-05-13 06:13:15,605 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:13:15,605 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:13:15,606 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:13:15,606 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:13:15,607 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:15,607 - src.main - INFO - Fetching new items...
2025-05-13 06:13:15,607 - src.main - INFO - Purged 1 old items from history (older than 7 days).
2025-05-13 06:13:15,607 - src.main - INFO - History contains 2 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:13:15,607 - src.main - INFO - Detecting sparks...
2025-05-13 06:13:15,607 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:13:15,607 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:13:15,609 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:15,609 - src.main - INFO - Fetching new items...
2025-05-13 06:13:15,609 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:13:15,609 - src.main - INFO - Detecting sparks...
2025-05-13 06:13:15,609 - src.main - INFO - Generating story seeds for 1 sparks...
2025-05-13 06:13:15,609 - src.main - ERROR - Failed to configure Gemini API. Skipping seed generation.
2025-05-13 06:13:15,609 - src.main - INFO - Generated 0 story seeds.
2025-05-13 06:13:15,609 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:13:15,612 - src.story_seed_generator - INFO - Google Generative AI client configured successfully.
2025-05-13 06:13:15,613 - src.story_seed_generator - ERROR - GOOGLE_API_KEY environment variable not set or found in .env file.
2025-05-13 06:13:15,615 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:13:15,616 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:13:15,622 - src.story_seed_generator - WARNING - Could not parse 'What If Questions' from LLM response.
Response snippet:

        Logline: A story about time travel.
        
        What If Questions:
        - What if time travel was real?
        ...
2025-05-13 06:13:15,623 - src.story_seed_generator - WARNING - Received empty text from Gemini response for parsing.
2025-05-13 06:13:15,623 - src.story_seed_generator - WARNING - Could not parse Logline from LLM response.
Response snippet:
This is not a properly formatted response...
2025-05-13 06:13:15,627 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:13:15,627 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:13:15,627 - src.story_seed_generator - INFO - Successfully generated and parsed story seed for spark: 'quantum'
2025-05-13 06:13:15,628 - src.story_seed_generator - INFO - Attempting to configure Gemini API before generation...
2025-05-13 06:13:15,628 - src.story_seed_generator - ERROR - Gemini client not configured and configuration attempt failed. Cannot generate seed.
2025-05-13 06:13:15,629 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:13:15,629 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 1/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:13:15,629 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 2/3) after 1 seconds...
2025-05-13 06:13:16,631 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 2/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:13:16,631 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 3/3) after 2 seconds...
2025-05-13 06:13:18,634 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 3/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:13:18,634 - src.story_seed_generator - ERROR - Failed to generate story seed after 3 attempts due to API errors.
2025-05-13 06:13:18,636 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:13:18,636 - src.story_seed_generator - WARNING - Gemini API returned no text content for spark 'quantum' (Attempt 1/3). Finish Reason: SAFETY, Block Reason: None, Safety Ratings: <Mock name='mock.safety_ratings' id='140713672953472'>
2025-05-13 06:13:18,636 - src.story_seed_generator - WARNING - Generation stopped due to safety/recitation (SAFETY). No retry.
2025-05-13 06:13:18,637 - src.story_seed_generator - ERROR - Prompt template 'generation.prompt_template' is missing in the configuration.
2025-05-13 06:13:18,639 - src.trend_detector - INFO - Analyzing 3 new items against 2 history items for sparks.
2025-05-13 06:13:18,640 - src.trend_detector - INFO - Detected Spark: 'computing' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Quantum Computing Breakthrough Announced
2025-05-13 06:13:18,640 - src.trend_detector - INFO - Detected Spark: 'quantum' from source 'test_source' (New Freq: 4, Hist Freq: 0) - Assoc. item: Another Quantum Development
2025-05-13 06:13:18,640 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:13:18,640 - src.trend_detector - INFO - Analyzing 1 new items against 1 history items for sparks.
2025-05-13 06:13:18,641 - src.trend_detector - INFO - Detected 0 sparks in this cycle.
2025-05-13 06:13:18,641 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:13:18,641 - src.trend_detector - INFO - Detected Spark: 'different' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:13:18,641 - src.trend_detector - INFO - Detected Spark: 'unique' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:13:18,641 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:13:18,642 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:13:18,642 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:13:18,643 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:13:18,643 - src.trend_detector - INFO - Detected Spark: 'blockchain' from source 'source2' (New Freq: 4, Hist Freq: 0) - Assoc. item: Blockchain Revolution
2025-05-13 06:13:18,643 - src.trend_detector - INFO - Detected 1 sparks in this cycle.
2025-05-13 06:13:29,882 - test.module - INFO - Test message
2025-05-13 06:13:29,886 - src.main - INFO - Creating data directory: data
2025-05-13 06:13:29,889 - src.main - WARNING - File not found: /nonexistent/file.json. Returning default.
2025-05-13 06:13:29,890 - src.main - ERROR - Error decoding JSON from /tmp/pytest-of-todd/pytest-23/test_load_json_invalid_format0/invalid.json: Expecting value: line 1 column 1 (char 0). Returning default.
2025-05-13 06:13:29,891 - src.main - INFO - Successfully saved 0 seeds to Markdown: /tmp/pytest-of-todd/pytest-23/test_save_seeds_empty0/test_sparks.md
2025-05-13 06:13:29,892 - src.main - INFO - Successfully saved 1 seeds to Markdown: /tmp/pytest-of-todd/pytest-23/test_save_seeds_with_data0/test_sparks.md
2025-05-13 06:13:29,893 - src.main - INFO - Successfully saved 2 seeds to Markdown: /tmp/pytest-of-todd/pytest-23/test_save_seeds_multiple0/test_sparks.md
2025-05-13 06:13:29,894 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:29,894 - src.main - INFO - Fetching new items...
2025-05-13 06:13:29,894 - src.main - INFO - No new items fetched in this cycle.
2025-05-13 06:13:29,894 - src.main - INFO - --- Agent Cycle Complete (No new items) ---
2025-05-13 06:13:29,896 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:29,896 - src.main - INFO - Fetching new items...
2025-05-13 06:13:29,896 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:13:29,896 - src.main - INFO - Detecting sparks...
2025-05-13 06:13:29,896 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:13:29,896 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:13:29,897 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:29,897 - src.main - INFO - Fetching new items...
2025-05-13 06:13:29,898 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:13:29,898 - src.main - INFO - Detecting sparks...
2025-05-13 06:13:29,898 - src.main - INFO - Generating story seeds for 2 sparks...
2025-05-13 06:13:29,898 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:13:29,898 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:13:29,898 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:13:29,898 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:13:29,900 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:29,900 - src.main - INFO - Fetching new items...
2025-05-13 06:13:29,900 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:13:29,900 - src.main - INFO - Detecting sparks...
2025-05-13 06:13:29,900 - src.main - INFO - Limiting seed generation to 2 sparks (out of 4 detected).
2025-05-13 06:13:29,900 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:13:29,900 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:13:29,900 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:13:29,900 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:13:29,901 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:29,901 - src.main - INFO - Fetching new items...
2025-05-13 06:13:29,901 - src.main - INFO - Purged 1 old items from history (older than 7 days).
2025-05-13 06:13:29,901 - src.main - INFO - History contains 2 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:13:29,902 - src.main - INFO - Detecting sparks...
2025-05-13 06:13:29,902 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:13:29,902 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:13:29,903 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:13:29,903 - src.main - INFO - Fetching new items...
2025-05-13 06:13:29,903 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:13:29,903 - src.main - INFO - Detecting sparks...
2025-05-13 06:13:29,903 - src.main - INFO - Generating story seeds for 1 sparks...
2025-05-13 06:13:29,903 - src.main - ERROR - Failed to configure Gemini API. Skipping seed generation.
2025-05-13 06:13:29,903 - src.main - INFO - Generated 0 story seeds.
2025-05-13 06:13:29,903 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:13:29,906 - src.story_seed_generator - INFO - Google Generative AI client configured successfully.
2025-05-13 06:13:29,908 - src.story_seed_generator - ERROR - GOOGLE_API_KEY environment variable not set or found in .env file.
2025-05-13 06:13:29,909 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:13:29,910 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:13:29,916 - src.story_seed_generator - WARNING - Could not parse 'What If Questions' from LLM response.
Response snippet:

        Logline: A story about time travel.
        
        What If Questions:
        - What if time travel was real?
        ...
2025-05-13 06:13:29,917 - src.story_seed_generator - WARNING - Received empty text from Gemini response for parsing.
2025-05-13 06:13:29,917 - src.story_seed_generator - WARNING - Could not parse Logline from LLM response.
Response snippet:
This is not a properly formatted response...
2025-05-13 06:13:29,920 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:13:29,921 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:13:29,921 - src.story_seed_generator - INFO - Successfully generated and parsed story seed for spark: 'quantum'
2025-05-13 06:13:29,922 - src.story_seed_generator - INFO - Attempting to configure Gemini API before generation...
2025-05-13 06:13:29,922 - src.story_seed_generator - ERROR - Gemini client not configured and configuration attempt failed. Cannot generate seed.
2025-05-13 06:13:29,923 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:13:29,923 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 1/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:13:29,923 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 2/3) after 1 seconds...
2025-05-13 06:13:30,924 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 2/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:13:30,925 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 3/3) after 2 seconds...
2025-05-13 06:13:32,927 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 3/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:13:32,928 - src.story_seed_generator - ERROR - Failed to generate story seed after 3 attempts due to API errors.
2025-05-13 06:13:32,930 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:13:32,930 - src.story_seed_generator - WARNING - Gemini API returned no text content for spark 'quantum' (Attempt 1/3). Finish Reason: SAFETY, Block Reason: None, Safety Ratings: <Mock name='mock.safety_ratings' id='139793988655024'>
2025-05-13 06:13:32,930 - src.story_seed_generator - WARNING - Generation stopped due to safety/recitation (SAFETY). No retry.
2025-05-13 06:13:32,931 - src.story_seed_generator - ERROR - Prompt template 'generation.prompt_template' is missing in the configuration.
2025-05-13 06:13:32,933 - src.trend_detector - INFO - Analyzing 3 new items against 2 history items for sparks.
2025-05-13 06:13:32,933 - src.trend_detector - INFO - Detected Spark: 'computing' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Quantum Computing Breakthrough Announced
2025-05-13 06:13:32,934 - src.trend_detector - INFO - Detected Spark: 'quantum' from source 'test_source' (New Freq: 4, Hist Freq: 0) - Assoc. item: Another Quantum Development
2025-05-13 06:13:32,934 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:13:32,934 - src.trend_detector - INFO - Analyzing 1 new items against 1 history items for sparks.
2025-05-13 06:13:32,934 - src.trend_detector - INFO - Detected 0 sparks in this cycle.
2025-05-13 06:13:32,935 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:13:32,935 - src.trend_detector - INFO - Detected Spark: 'unique' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:13:32,935 - src.trend_detector - INFO - Detected Spark: 'different' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:13:32,935 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:13:32,936 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:13:32,936 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:13:32,936 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:13:32,937 - src.trend_detector - INFO - Detected Spark: 'blockchain' from source 'source2' (New Freq: 4, Hist Freq: 0) - Assoc. item: Blockchain Revolution
2025-05-13 06:13:32,937 - src.trend_detector - INFO - Detected 1 sparks in this cycle.
2025-05-13 06:14:30,740 - test.module - INFO - Test message
2025-05-13 06:14:30,744 - src.main - INFO - Creating data directory: data
2025-05-13 06:14:30,747 - src.main - WARNING - File not found: /nonexistent/file.json. Returning default.
2025-05-13 06:14:30,748 - src.main - ERROR - Error decoding JSON from /tmp/pytest-of-todd/pytest-24/test_load_json_invalid_format0/invalid.json: Expecting value: line 1 column 1 (char 0). Returning default.
2025-05-13 06:14:30,749 - src.main - INFO - Successfully saved 0 seeds to Markdown: /tmp/pytest-of-todd/pytest-24/test_save_seeds_empty0/test_sparks.md
2025-05-13 06:14:30,750 - src.main - INFO - Successfully saved 1 seeds to Markdown: /tmp/pytest-of-todd/pytest-24/test_save_seeds_with_data0/test_sparks.md
2025-05-13 06:14:30,751 - src.main - INFO - Successfully saved 2 seeds to Markdown: /tmp/pytest-of-todd/pytest-24/test_save_seeds_multiple0/test_sparks.md
2025-05-13 06:14:30,753 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:14:30,753 - src.main - INFO - Fetching new items...
2025-05-13 06:14:30,753 - src.main - INFO - No new items fetched in this cycle.
2025-05-13 06:14:30,753 - src.main - INFO - --- Agent Cycle Complete (No new items) ---
2025-05-13 06:14:30,755 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:14:30,755 - src.main - INFO - Fetching new items...
2025-05-13 06:14:30,755 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:14:30,755 - src.main - INFO - Detecting sparks...
2025-05-13 06:14:30,755 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:14:30,755 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:14:30,756 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:14:30,757 - src.main - INFO - Fetching new items...
2025-05-13 06:14:30,757 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:14:30,757 - src.main - INFO - Detecting sparks...
2025-05-13 06:14:30,757 - src.main - INFO - Generating story seeds for 2 sparks...
2025-05-13 06:14:30,757 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:14:30,757 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:14:30,757 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:14:30,757 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:14:30,758 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:14:30,759 - src.main - INFO - Fetching new items...
2025-05-13 06:14:30,759 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:14:30,759 - src.main - INFO - Detecting sparks...
2025-05-13 06:14:30,759 - src.main - INFO - Limiting seed generation to 2 sparks (out of 4 detected).
2025-05-13 06:14:30,759 - src.main - INFO - Successfully generated seed for spark: test1
2025-05-13 06:14:30,759 - src.main - INFO - Successfully generated seed for spark: test2
2025-05-13 06:14:30,759 - src.main - INFO - Generated 2 story seeds.
2025-05-13 06:14:30,759 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:14:30,760 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:14:30,760 - src.main - INFO - Fetching new items...
2025-05-13 06:14:30,760 - src.main - INFO - Purged 1 old items from history (older than 7 days).
2025-05-13 06:14:30,760 - src.main - INFO - History contains 2 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:14:30,760 - src.main - INFO - Detecting sparks...
2025-05-13 06:14:30,760 - src.main - INFO - No sparks detected in this cycle.
2025-05-13 06:14:30,760 - src.main - INFO - --- Agent Cycle Complete (No sparks) ---
2025-05-13 06:14:30,762 - src.main - INFO - --- Starting Agent Cycle ---
2025-05-13 06:14:30,762 - src.main - INFO - Fetching new items...
2025-05-13 06:14:30,762 - src.main - INFO - History contains 3 items (after update/purge). Using 1 for baseline comparison.
2025-05-13 06:14:30,762 - src.main - INFO - Detecting sparks...
2025-05-13 06:14:30,762 - src.main - INFO - Generating story seeds for 1 sparks...
2025-05-13 06:14:30,762 - src.main - ERROR - Failed to configure Gemini API. Skipping seed generation.
2025-05-13 06:14:30,762 - src.main - INFO - Generated 0 story seeds.
2025-05-13 06:14:30,762 - src.main - INFO - --- Agent Cycle Complete ---
2025-05-13 06:14:30,803 - src.main - ERROR - Error saving data to /invalid/path.json: Cannot write
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/main.py", line 40, in _save_json
    with open(filepath, 'w', encoding='utf-8') as f:
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
OSError: Cannot write
2025-05-13 06:14:30,806 - src.story_seed_generator - INFO - Google Generative AI client configured successfully.
2025-05-13 06:14:30,808 - src.story_seed_generator - ERROR - GOOGLE_API_KEY environment variable not set or found in .env file.
2025-05-13 06:14:30,811 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:14:30,812 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:14:30,817 - src.story_seed_generator - WARNING - Could not parse 'What If Questions' from LLM response.
Response snippet:

        Logline: A story about time travel.
        
        What If Questions:
        - What if time travel was real?
        ...
2025-05-13 06:14:30,818 - src.story_seed_generator - WARNING - Received empty text from Gemini response for parsing.
2025-05-13 06:14:30,819 - src.story_seed_generator - WARNING - Could not parse Logline from LLM response.
Response snippet:
This is not a properly formatted response...
2025-05-13 06:14:30,822 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:14:30,822 - src.story_seed_generator - INFO - Successfully parsed LLM response into logline, questions, and keywords.
2025-05-13 06:14:30,823 - src.story_seed_generator - INFO - Successfully generated and parsed story seed for spark: 'quantum'
2025-05-13 06:14:30,824 - src.story_seed_generator - INFO - Attempting to configure Gemini API before generation...
2025-05-13 06:14:30,824 - src.story_seed_generator - ERROR - Gemini client not configured and configuration attempt failed. Cannot generate seed.
2025-05-13 06:14:30,825 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:14:30,825 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 1/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:14:30,825 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 2/3) after 1 seconds...
2025-05-13 06:14:31,826 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 2/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:14:31,827 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 3/3) after 2 seconds...
2025-05-13 06:14:33,829 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 3/3) for spark 'quantum': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 185, in generate_story_seed
    response = model.generate_content(prompt) #, safety_settings=safety_settings)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:14:33,830 - src.story_seed_generator - ERROR - Failed to generate story seed after 3 attempts due to API errors.
2025-05-13 06:14:33,832 - src.story_seed_generator - INFO - Generating story seed for spark: 'quantum' from 'test_source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:14:33,832 - src.story_seed_generator - WARNING - Gemini API returned no text content for spark 'quantum' (Attempt 1/3). Finish Reason: SAFETY, Block Reason: None, Safety Ratings: <Mock name='mock.safety_ratings' id='140026985576432'>
2025-05-13 06:14:33,832 - src.story_seed_generator - WARNING - Generation stopped due to safety/recitation (SAFETY). No retry.
2025-05-13 06:14:33,833 - src.story_seed_generator - ERROR - Prompt template 'generation.prompt_template' is missing in the configuration.
2025-05-13 06:14:33,834 - src.story_seed_generator - INFO - Google Generative AI client configured successfully.
2025-05-13 06:14:33,838 - src.story_seed_generator - ERROR - Failed to configure Google Generative AI: Config error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 33, in configure_genai
    genai.configure(api_key=api_key)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Config error
2025-05-13 06:14:33,839 - src.story_seed_generator - WARNING - Could not parse Logline from LLM response.
Response snippet:

    **What If Questions:**
    - Question 1
    
    **Thematic Keywords:**
    - Keyword 1
    ...
2025-05-13 06:14:33,840 - src.story_seed_generator - WARNING - Received empty text from Gemini response for parsing.
2025-05-13 06:14:33,841 - src.story_seed_generator - ERROR - Error parsing Gemini response: Regex error
Response Text (first 500 chars):
Test text...
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 55, in _parse_gemini_response
    logline_match = re.search(logline_pattern, text, re.IGNORECASE | re.DOTALL | re.MULTILINE)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Regex error
2025-05-13 06:14:33,841 - src.story_seed_generator - ERROR - Prompt template 'generation.prompt_template' is missing in the configuration.
2025-05-13 06:14:33,842 - src.story_seed_generator - ERROR - Error formatting prompt template. Missing key: 'missing_key'. Template: 'Template with {missing_key}'
2025-05-13 06:14:33,843 - src.story_seed_generator - INFO - Generating story seed for spark: 'test' from 'Test Source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:14:33,843 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 1/2) for spark 'test': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 178, in generate_story_seed
    model = genai.GenerativeModel(model_name)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:14:33,843 - src.story_seed_generator - INFO - Retrying Gemini request after error (attempt 2/2) after 0.1 seconds...
2025-05-13 06:14:33,943 - src.story_seed_generator - ERROR - Error during Gemini API call (attempt 2/2) for spark 'test': API Error
Traceback (most recent call last):
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 178, in generate_story_seed
    model = genai.GenerativeModel(model_name)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
  File "/home/todd/storyspark-agent/src/story_seed_generator.py", line 178, in generate_story_seed
    model = genai.GenerativeModel(model_name)
  File "/usr/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: API Error
2025-05-13 06:14:33,944 - src.story_seed_generator - ERROR - Failed to generate story seed after 2 attempts due to API errors.
2025-05-13 06:14:33,946 - src.story_seed_generator - INFO - Generating story seed for spark: 'test' from 'Test Source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:14:33,946 - src.story_seed_generator - WARNING - Gemini API returned no text content for spark 'test' (Attempt 1/2). Finish Reason: STOP, Block Reason: None, Safety Ratings: <Mock name='mock.safety_ratings' id='140026983954656'>
2025-05-13 06:14:33,946 - src.story_seed_generator - WARNING - Model stopped normally but produced no text. Retrying might help.
2025-05-13 06:14:33,946 - src.story_seed_generator - INFO - Retrying Gemini request (attempt 2/2) after 0.01 seconds...
2025-05-13 06:14:33,957 - src.story_seed_generator - WARNING - Gemini API returned no text content for spark 'test' (Attempt 2/2). Finish Reason: STOP, Block Reason: None, Safety Ratings: <Mock name='mock.safety_ratings' id='140026983954656'>
2025-05-13 06:14:33,957 - src.story_seed_generator - WARNING - Model stopped normally but produced no text. Retrying might help.
2025-05-13 06:14:33,957 - src.story_seed_generator - ERROR - Gemini returned no text content after 2 attempts or retry not warranted.
2025-05-13 06:14:33,958 - src.story_seed_generator - INFO - Generating story seed for spark: 'test' from 'Test Source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:14:33,959 - src.story_seed_generator - WARNING - Gemini API returned no text content for spark 'test' (Attempt 1/2). Finish Reason: None, Block Reason: SAFETY, Safety Ratings: <Mock name='GenerativeModel().generate_content().prompt_feedback.safety_ratings' id='140026983771456'>
2025-05-13 06:14:33,959 - src.story_seed_generator - WARNING - Generation blocked due to safety settings (SAFETY). No retry.
2025-05-13 06:14:33,960 - src.story_seed_generator - INFO - Generating story seed for spark: 'test' from 'Test Source' using model 'gemini-1.5-flash-latest'
2025-05-13 06:14:33,960 - src.story_seed_generator - WARNING - Gemini API returned no text content for spark 'test' (Attempt 1/3). Finish Reason: MAX_TOKENS, Block Reason: None, Safety Ratings: <Mock name='mock.safety_ratings' id='140026983947264'>
2025-05-13 06:14:33,960 - src.story_seed_generator - WARNING - Generation stopped due to max tokens. Consider revising prompt or model settings. No retry.
2025-05-13 06:14:33,963 - src.trend_detector - INFO - Analyzing 3 new items against 2 history items for sparks.
2025-05-13 06:14:33,963 - src.trend_detector - INFO - Detected Spark: 'quantum' from source 'test_source' (New Freq: 4, Hist Freq: 0) - Assoc. item: Another Quantum Development
2025-05-13 06:14:33,963 - src.trend_detector - INFO - Detected Spark: 'computing' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Quantum Computing Breakthrough Announced
2025-05-13 06:14:33,963 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:14:33,964 - src.trend_detector - INFO - Analyzing 1 new items against 1 history items for sparks.
2025-05-13 06:14:33,964 - src.trend_detector - INFO - Detected 0 sparks in this cycle.
2025-05-13 06:14:33,964 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:14:33,964 - src.trend_detector - INFO - Detected Spark: 'unique' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:14:33,965 - src.trend_detector - INFO - Detected Spark: 'different' from source 'test_source' (New Freq: 2, Hist Freq: 0) - Assoc. item: Another Unique Topic
2025-05-13 06:14:33,965 - src.trend_detector - INFO - Detected 2 sparks in this cycle.
2025-05-13 06:14:33,965 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:14:33,965 - src.trend_detector - INFO - No new items to analyze for sparks.
2025-05-13 06:14:33,966 - src.trend_detector - INFO - Analyzing 2 new items against 0 history items for sparks.
2025-05-13 06:14:33,966 - src.trend_detector - INFO - Detected Spark: 'blockchain' from source 'source2' (New Freq: 4, Hist Freq: 0) - Assoc. item: Blockchain Revolution
2025-05-13 06:14:33,966 - src.trend_detector - INFO - Detected 1 sparks in this cycle.
